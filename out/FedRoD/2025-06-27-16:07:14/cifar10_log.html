==================== FedRoD ====================                                                                                         
Experiment Arguments:                                                                                                                    
{                                                                                                                                        
    'model': 'lenet5',                                                                                                                   
    'dataset': 'cifar10',                                                                                                                
    'seed': 42,                                                                                                                          
    'join_ratio': 0.1,                                                                                                                   
    'global_epoch': 100,                                                                                                                 
    'local_epoch': 5,                                                                                                                    
    'finetune_epoch': 0,                                                                                                                 
    'test_gap': 100,                                                                                                                     
    'eval_test': 1,                                                                                                                      
    'eval_val': 0,                                                                                                                       
    'eval_train': 0,                                                                                                                     
    'optimizer': 'sgd',                                                                                                                  
    'local_lr': 0.01,                                                                                                                    
    'momentum': 0.0,                                                                                                                     
    'weight_decay': 0.0,                                                                                                                 
    'verbose_gap': 10,                                                                                                                   
    'batch_size': 32,                                                                                                                    
    'visible': 0,                                                                                                                        
    'straggler_ratio': 0,                                                                                                                
    'straggler_min_local_epoch': 1,                                                                                                      
    'external_model_params_file': '',                                                                                                    
    'use_cuda': 1,                                                                                                                       
    'save_log': 1,                                                                                                                       
    'save_model': 0,                                                                                                                     
    'save_fig': 1,                                                                                                                       
    'save_metrics': 1,                                                                                                                   
    'viz_win_name': None,                                                                                                                
    'config_file': '',                                                                                                                   
    'check_convergence': 1,                                                                                                              
    'gamma': 1,                                                                                                                          
    'hyper': 1,                                                                                                                          
    'hyper_lr': 0.1,                                                                                                                     
    'hyper_hidden_dim': 32,                                                                                                              
    'eval_per': 1,                                                                                                                       
    'dataset_args': {                                                                                                                    
        'dataset': 'cifar10',                                                                                                            
        'client_num': 100,                                                                                                               
        'test_ratio': 0.25,                                                                                                              
        'val_ratio': 0.0,                                                                                                                
        'seed': 42,                                                                                                                      
        'split': 'sample',                                                                                                               
        'alpha': 0.1,                                                                                                                    
        'least_samples': 40                                                                                                              
    }                                                                                                                                    
}                                                                                                                                        
-------------------------- TRAINING EPOCH: 10 --------------------------                                                                 
client [77] (test)  loss: 2.6658 -> 1.6137   accuracy: 47.79% -> 57.52%                                                                  
client [81] (test)  loss: 4.9457 -> 2.2080   accuracy: 11.71% -> 39.64%                                                                  
client [21] (test)  loss: 5.8842 -> 0.5534   accuracy: 2.80% -> 77.57%                                                                   
client [68] (test)  loss: 4.2018 -> 0.6030   accuracy: 13.79% -> 81.90%                                                                  
client [93] (test)  loss: 5.5859 -> 0.4269   accuracy: 0.00% -> 87.50%                                                                   
client [31] (test)  loss: 4.0554 -> 0.6374   accuracy: 3.41% -> 75.00%                                                                   
client [20] (test)  loss: 4.9454 -> 0.1954   accuracy: 0.00% -> 91.75%                                                                   
client [59] (test)  loss: 7.4529 -> 0.2777   accuracy: 1.35% -> 94.93%                                                                   
client [48] (test)  loss: 4.5071 -> 0.6964   accuracy: 0.00% -> 78.57%                                                                   
client [34] (test)  loss: 4.4896 -> 0.4236   accuracy: 5.56% -> 86.81%                                                                   
-------------------------- TRAINING EPOCH: 20 --------------------------                                                                 
client [69] (test)  loss: 2.2424 -> 0.8360   accuracy: 54.48% -> 72.39%                                                                  
client [99] (test)  loss: 3.2056 -> 1.7232   accuracy: 24.71% -> 44.71%                                                                  
client [67] (test)  loss: 3.0246 -> 0.8332   accuracy: 15.00% -> 80.00%                                                                  
client [0] (test)  loss: 3.4092 -> 0.5944   accuracy: 1.18% -> 79.33%                                                                    
client [76] (test)  loss: 3.2113 -> 0.5378   accuracy: 10.60% -> 76.96%                                                                  
client [41] (test)  loss: 7.9519 -> 1.4417   accuracy: 0.00% -> 57.34%                                                                   
client [62] (test)  loss: 2.0295 -> 0.1430   accuracy: 2.02% -> 94.33%                                                                   
client [2] (test)  loss: 1.0914 -> 0.7508   accuracy: 84.21% -> 78.95%                                                                   
client [14] (test)  loss: 1.4167 -> 0.0713   accuracy: 19.05% -> 97.28%                                                                  
client [46] (test)  loss: 5.8073 -> 0.2638   accuracy: 15.24% -> 92.38%                                                                  
-------------------------- TRAINING EPOCH: 30 --------------------------                                                                 
client [24] (test)  loss: 0.6259 -> 0.6048   accuracy: 83.02% -> 76.73%                                                                  
client [68] (test)  loss: 5.0105 -> 0.5156   accuracy: 9.48% -> 85.34%                                                                   
client [57] (test)  loss: 4.0843 -> 0.6674   accuracy: 0.42% -> 71.73%                                                                   
client [17] (test)  loss: 5.2258 -> 0.1881   accuracy: 0.00% -> 96.42%                                                                   
client [54] (test)  loss: 8.9949 -> 0.3218   accuracy: 8.28% -> 89.07%                                                                   
client [23] (test)  loss: 4.4852 -> 0.9635   accuracy: 0.00% -> 64.71%                                                                   
client [35] (test)  loss: 3.2072 -> 0.5216   accuracy: 0.00% -> 85.71%                                                                   
client [59] (test)  loss: 14.7173 -> 0.1914   accuracy: 0.00% -> 95.27%                                                                  
client [31] (test)  loss: 3.5257 -> 1.3095   accuracy: 11.36% -> 39.77%                                                                  
client [9] (test)  loss: 5.8066 -> 0.1705   accuracy: 0.00% -> 95.20%                                                                    
-------------------------- TRAINING EPOCH: 40 --------------------------                                                                 
client [64] (test)  loss: 7.9323 -> 0.7164   accuracy: 0.00% -> 76.92%                                                                   
client [33] (test)  loss: 1.0627 -> 0.6173   accuracy: 68.42% -> 77.63%                                                                  
client [16] (test)  loss: 6.9627 -> 0.4829   accuracy: 0.00% -> 78.65%                                                                   
client [44] (test)  loss: 4.7116 -> 0.0412   accuracy: 0.00% -> 98.54%                                                                   
client [8] (test)  loss: 4.9526 -> 0.0004   accuracy: 7.22% -> 100.00%                                                                   
client [31] (test)  loss: 5.0154 -> 0.8805   accuracy: 0.00% -> 75.00%                                                                   
client [47] (test)  loss: 6.1859 -> 1.2514   accuracy: 2.88% -> 59.71%                                                                   
client [36] (test)  loss: 3.2998 -> 0.2640   accuracy: 38.60% -> 89.47%                                                                  
client [20] (test)  loss: 4.0763 -> 0.1612   accuracy: 7.22% -> 94.85%                                                                   
client [56] (test)  loss: 0.9362 -> 0.4762   accuracy: 69.32% -> 92.05%                                                                  
-------------------------- TRAINING EPOCH: 50 --------------------------                                                                 
client [4] (test)  loss: 3.7169 -> 0.5630   accuracy: 6.25% -> 85.71%                                                                    
client [60] (test)  loss: 5.4325 -> 0.2501   accuracy: 3.33% -> 94.17%                                                                   
client [28] (test)  loss: 5.7155 -> 1.0472   accuracy: 5.38% -> 64.52%                                                                   
client [25] (test)  loss: 0.7522 -> 1.1018   accuracy: 69.84% -> 75.56%                                                                  
client [58] (test)  loss: 8.5576 -> 0.4221   accuracy: 0.00% -> 88.76%                                                                   
client [44] (test)  loss: 5.7192 -> 0.0365   accuracy: 0.00% -> 99.27%                                                                   
client [39] (test)  loss: 4.0327 -> 0.3425   accuracy: 6.10% -> 87.80%                                                                   
client [29] (test)  loss: 3.8665 -> 0.3489   accuracy: 12.50% -> 86.54%                                                                  
client [3] (test)  loss: 5.3097 -> 0.3291   accuracy: 1.95% -> 88.31%                                                                    
client [84] (test)  loss: 1.3886 -> 0.9855   accuracy: 64.77% -> 63.64%                                                                  
-------------------------- TRAINING EPOCH: 60 --------------------------                                                                 
client [21] (test)  loss: 3.1797 -> 0.4749   accuracy: 20.56% -> 78.50%                                                                  
client [84] (test)  loss: 2.9781 -> 0.7926   accuracy: 36.36% -> 79.55%                                                                  
client [10] (test)  loss: 3.9085 -> 0.5112   accuracy: 27.03% -> 83.78%                                                                  
client [36] (test)  loss: 2.9627 -> 0.3077   accuracy: 38.60% -> 87.72%                                                                  
client [65] (test)  loss: 4.1656 -> 0.6131   accuracy: 5.51% -> 80.31%                                                                   
client [81] (test)  loss: 3.4920 -> 0.8875   accuracy: 36.94% -> 69.37%                                                                  
client [79] (test)  loss: 3.4154 -> 0.5908   accuracy: 20.00% -> 75.29%                                                                  
client [42] (test)  loss: 3.9008 -> 0.0742   accuracy: 11.32% -> 98.29%                                                                  
client [11] (test)  loss: 5.6495 -> 0.5477   accuracy: 39.09% -> 77.16%                                                                  
client [96] (test)  loss: 4.6048 -> 0.9761   accuracy: 5.77% -> 65.38%                                                                   
-------------------------- TRAINING EPOCH: 70 --------------------------                                                                 
client [8] (test)  loss: 2.6960 -> 0.0002   accuracy: 32.32% -> 100.00%                                                                  
client [53] (test)  loss: 0.9046 -> 0.2584   accuracy: 86.79% -> 90.57%                                                                  
client [52] (test)  loss: 4.8608 -> 0.2500   accuracy: 8.67% -> 91.95%                                                                   
client [42] (test)  loss: 7.2593 -> 0.0735   accuracy: 0.21% -> 98.50%                                                                   
client [69] (test)  loss: 6.9101 -> 0.6190   accuracy: 7.46% -> 77.61%                                                                   
client [59] (test)  loss: 1.2253 -> 0.1947   accuracy: 57.43% -> 95.27%                                                                  
client [7] (test)  loss: 5.2567 -> 1.7849   accuracy: 2.78% -> 63.89%                                                                    
client [26] (test)  loss: 4.5478 -> 0.3724   accuracy: 0.00% -> 89.19%                                                                   
client [49] (test)  loss: 5.2577 -> 0.0313   accuracy: 0.00% -> 99.64%                                                                   
client [98] (test)  loss: 5.7184 -> 0.8918   accuracy: 0.00% -> 66.67%                                                                   
-------------------------- TRAINING EPOCH: 80 --------------------------                                                                 
client [98] (test)  loss: 6.2880 -> 1.1244   accuracy: 3.03% -> 57.58%                                                                   
client [47] (test)  loss: 4.8402 -> 0.6787   accuracy: 12.23% -> 84.17%                                                                  
client [21] (test)  loss: 6.8809 -> 0.4502   accuracy: 0.00% -> 84.11%                                                                   
client [77] (test)  loss: 5.1530 -> 0.6946   accuracy: 1.77% -> 79.65%                                                                   
client [95] (test)  loss: 5.3243 -> 0.2857   accuracy: 0.00% -> 90.48%                                                                   
client [91] (test)  loss: 6.2195 -> 0.5214   accuracy: 1.35% -> 81.08%                                                                   
client [14] (test)  loss: 5.0167 -> 0.0682   accuracy: 0.68% -> 98.30%                                                                   
client [99] (test)  loss: 5.8801 -> 1.2330   accuracy: 21.18% -> 51.76%                                                                  
client [20] (test)  loss: 1.4684 -> 0.1442   accuracy: 54.64% -> 93.81%                                                                  
client [39] (test)  loss: 4.3399 -> 0.3517   accuracy: 10.37% -> 91.46%                                                                  
-------------------------- TRAINING EPOCH: 90 --------------------------                                                                 
client [52] (test)  loss: 6.2929 -> 0.6041   accuracy: 4.33% -> 81.11%                                                                   
client [62] (test)  loss: 5.1096 -> 0.1415   accuracy: 8.10% -> 95.14%                                                                   
client [71] (test)  loss: 3.9330 -> 0.0426   accuracy: 7.38% -> 97.54%                                                                   
client [97] (test)  loss: 3.3252 -> 0.0003   accuracy: 22.71% -> 100.00%                                                                 
client [30] (test)  loss: 9.3569 -> 1.8969   accuracy: 0.00% -> 66.67%                                                                   
client [88] (test)  loss: 2.4801 -> 0.4339   accuracy: 11.76% -> 85.29%                                                                  
client [60] (test)  loss: 3.9577 -> 0.3361   accuracy: 14.17% -> 93.33%                                                                  
client [82] (test)  loss: 5.7978 -> 1.0417   accuracy: 4.49% -> 64.04%                                                                   
client [91] (test)  loss: 3.9893 -> 0.5445   accuracy: 1.35% -> 82.43%                                                                   
client [57] (test)  loss: 2.1880 -> 1.4401   accuracy: 38.82% -> 51.05%                                                                  
-------------------------- TRAINING EPOCH: 100 --------------------------                                                                
client [31] (test)  loss: 3.1285 -> 0.9547   accuracy: 9.09% -> 73.86%                                                                   
client [15] (test)  loss: 3.1329 -> 0.6711   accuracy: 19.51% -> 73.17%                                                                  
client [71] (test)  loss: 3.8076 -> 0.0664   accuracy: 6.56% -> 97.54%                                                                   
client [97] (test)  loss: 3.5138 -> 0.0004   accuracy: 18.56% -> 100.00%                                                                 
client [53] (test)  loss: 6.7496 -> 0.3010   accuracy: 3.77% -> 88.68%                                                                   
client [77] (test)  loss: 4.6165 -> 0.6357   accuracy: 14.16% -> 76.99%                                                                  
client [76] (test)  loss: 6.0185 -> 0.4510   accuracy: 0.00% -> 81.11%                                                                   
client [79] (test)  loss: 9.3674 -> 0.6901   accuracy: 10.59% -> 74.12%                                                                  
client [28] (test)  loss: 3.2931 -> 0.8346   accuracy: 23.66% -> 76.34%                                                                  
client [99] (test)  loss: 3.4114 -> 1.3154   accuracy: 29.41% -> 52.94%                                                                  
FedRoD's average time taken by each global epoch: 0 m 16.04 s.                                                                           
FedRoD's total running time: 0 h 26 m 46 s.                                                                                              
==================== FedRoD Experiment Results: ====================                                                                     
Format: (before local fine-tuning) -> (after local fine-tuning)                                                                          
{100: {'all_clients': {'test': {'loss': '0.9554 -> 0.0000', 'accuracy': '70.71% -> 0.00%'}}}}                                            
========== FedRoD Convergence on train clients ==========                                                                                
test (before local training):                                                                                                            
20.0%(23.59%) at epoch: 2                                                                                                                
30.0%(32.24%) at epoch: 27                                                                                                               
40.0%(44.29%) at epoch: 43                                                                                                               
50.0%(51.07%) at epoch: 94                                                                                                               
test (after local training):                                                                                                             
70.0%(78.53%) at epoch: 0                                                                                                                
80.0%(83.66%) at epoch: 1                                                                                                                
90.0%(93.42%) at epoch: 11                                                                                                               
==================== FedRoD Max Accuracy ====================                                                                            
all_clients:                                                                                                                             
(test) before fine-tuning: 70.71% at epoch 100                                                                                           
(test) after fine-tuning: 0.00% at epoch 100                                                                                             
